{% extends "base.html" %}

{% block content %}
<h2 class="mb-3">Meklējumu un skatījumu vēsture</h2>
<div class="row g-3">
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">Pēdējie meklējumi</div>
            <div class="card-body">
                {% if history %}
                    <ul class="list-unstyled mb-0">
                        {% for item in history %}
                            <li class="d-flex justify-content-between">
                                <span>{{ item.query }}</span>
                                <span class="text-muted small">{{ item.created_at[:16].replace('T', ' ') }}</span>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-muted mb-0">Nav vēstures.</p>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">Saglabātie meklējumi</div>
            <div class="card-body">
                {% if saved %}
                    <ul class="list-unstyled mb-0">
                        {% for item in saved %}
                            <li class="d-flex justify-content-between align-items-center">
                                <a href="{{ url_for('index', q=item.query) }}">{{ item.query }}</a>
                                <form method="post" action="{{ url_for('remove_saved_search') }}">
                                    <input type="hidden" name="search_id" value="{{ item.id }}">
                                    <button class="btn btn-sm btn-outline-danger" type="submit">Noņemt</button>
                                </form>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-muted mb-0">Nav saglabātu meklējumu.</p>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">Skatītie raksti</div>
            <div class="card-body">
                {% if viewed %}
                    <ul class="list-unstyled mb-0">
                        {% for item in viewed %}
                            <li class="mb-2">
                                <a href="{{ url_for('open_article', article_id=item.id) }}" target="_blank">{{ item.title }}</a>
                                <div class="small text-muted">{{ item.viewed_at[:16].replace('T', ' ') }}</div>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-muted mb-0">Nav skatīto rakstu.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
